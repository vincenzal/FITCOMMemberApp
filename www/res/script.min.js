!function(e){"use strict";e.ajaxSetup({url:"http://fitcom.plusdrei.at/mobile/app/",method:"POST"});var t=2016,o="1.1.4";e(document).ready(function(){function t(){switch("undefined"!=typeof StatusBar&&StatusBar.hide(),document.addEventListener("resume",function(){setTimeout(function(){top.location.href="userbereich.html"},20)},!1),e("body").append(e('<div id="overlay"><span></span></div>')),e("body").attr("id")){case"site-index":e("input[type=checkbox]").makeNiceCheckbox(),"?logout"===document.location.search?(l("logout"),r(),e("#error2").show()):"?error3"===document.location.search?(e("h1, hr, .sitetext, #disclaimer, #login-area").hide(),e("#error3").show()):(l("site-index"),p(d));break;case"site-userbereich":l("site-userbereich"),p(!1,function(){setTimeout(function(){r(),top.location.href="index.html"},200)}),f();break;case"site-pwdchange":l("site-pwdchange"),p(!1,function(){setTimeout(function(){r(),top.location.href="index.html"},200)});break;case"site-trainingsplan":l("site-trainingsplan"),p(!1,function(){setTimeout(function(){r(),top.location.href="index.html"},200)}),i()}}e("header button#nav-show").on("click",function(){return e(".site-nav ul").addClass("menu-visible"),e("#nav-show").removeClass("button-visible"),e("#nav-hide").addClass("button-visible"),!1}),e("header button#nav-hide").on("click",function(){e(".site-nav ul").removeClass("menu-visible"),e("#nav-hide").removeClass("button-visible"),e("#nav-show").addClass("button-visible")}),setTimeout(function(){r(),top.location.href="index.html"},72e5),document.addEventListener("deviceready",t,!1)});var i=function(){for(var o=new Date,i=o.getFullYear(),a=i;a>=t;a--)e("#selectYear").append(e("<option "+(a===i?"selected":"")+">"+a+"</option>"));n(i)},n=function(t){g(!0),e("#select-year-text span").html(t),e.ajax({data:{type:"loadtraining",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),year:t,checkTrainging:!0}}).done(function(e){return""!==e&&(e=JSON.parse(e)),e.error?void c():void(e.days&&(e=e.days,a(t,e)))}).fail(function(){b()})},a=function(t,o){var i,n,a,c,r,s,d=new Date,u=["Jänner","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],l="";for(var p in u)if("string"==typeof u[p]){for(p*=1,l+='<table class="table-trainingsplan">',l+="<tr "+(p===d.getMonth()&&1*t===d.getFullYear()?'data-scrollhere="1"':"")+'><td class="table-month" colspan="7">'+u[p]+"</td></tr>",l+='<tr class="training-week"><td>Mo</td><td>Di</td><td>Mi</td><td>Do</td><td>Fr</td><td>Sa</td><td>So</td></tr>',i=new Date(t,p+1,0),n=new Date(t,p,1),a=n.getDay()-2,c=i.getDate(),-1>a&&(a+=7),r=0;(c+a>=35?42:35)>r;r++)r%7===0&&(l+="<tr>"),c>=r-a&&r-a>0?(s=t+"-"+(10>p+1?"0":"")+(p+1)+"-"+(10>r-a?"0":"")+(r-a),l+=o.indexOf(s)>-1?'<td class="training-day-active '+(o.indexOf("X"+s)>-1?"training-day-active-data":"")+' training-ok"><a href="userbereich.html?d='+s+'">'+(r-a)+"</a></td>":'<td class="training-day-active">'+(r-a)+"</td>"):l+="<td></td>",r%7===6&&(l+="</tr>");l+="</table>"}if(e("#cal").html(l),g(!1),e('[data-scrollhere="1"]').length>0){var m=e('[data-scrollhere="1"]').offset();window.scrollTo(0,m.top-30)}},c=function(){top.location.href="index.html?logout"},r=function(){sessionStorage.clear(),localStorage.clear()},s=function(t){return t.preventDefault(),""===e("#username").val()||""===e("#password").val()?!1:(g(!0),void e.ajax({data:{type:"login",email:e("#username").val(),password:e("#password").val(),eingeloggtbleiben:e("#eingeloggtbleiben").prop("checked")}}).done(function(t){return""!==t&&(t=JSON.parse(t)),t.error?void c():void(t.userOK?(sessionStorage.setItem("fitcomLogin",!0),sessionStorage.setItem("fitcomLogin_uid",t.uid),sessionStorage.setItem("fitcomLogin_sid",t.sid),e("#eingeloggtbleiben").prop("checked")&&(localStorage.setItem("fitcomLogin",!0),localStorage.setItem("fitcomLogin_uid",t.uid),localStorage.setItem("fitcomLogin_sid",t.sid)),d()):(l("wrong-login "+e("#username").val()),setTimeout(function(){g(!1),e("#error1").show()},2e3)))}).fail(function(){b()}))},d=function(){setTimeout(function(){top.location.href="userbereich.html"},200)},u=function(t){var o="";switch(device.platform){case"Android":o=t.androidStoreLink;break;case"iOS":o=t.iOSStoreLink}e("body").append(e('<div id="overlayStore"><p>Es gibt eine neue Version der FITCOM-App. Bitte mache ein Update.</p><p><br><br>'+o+"</p></div>").show())};e(document).on("click","a[target=_blank]",function(e){e.preventDefault(),window.open(this.href,"_system")}),e(document).on("click","a[target=_system]",function(e){e.preventDefault(),window.open(this.href,"_system")});var l=function(t){e.ajax({data:{type:"logit",uid:sessionStorage.getItem("fitcomLogin_uid"),content:t,appVersion:o}}).done(function(e){""!==e&&(e=JSON.parse(e)),e.update&&u(e)}).fail(function(){b()})},p=function(e,t){localStorage.getItem("fitcomLogin")&&!sessionStorage.getItem("fitcomLogin")&&(sessionStorage.setItem("fitcomLogin",!0),sessionStorage.setItem("fitcomLogin_uid",localStorage.getItem("fitcomLogin_uid")),sessionStorage.setItem("fitcomLogin_sid",localStorage.getItem("fitcomLogin_sid")));var o=localStorage.getItem("fitcomLogin")||sessionStorage.getItem("fitcomLogin");e&&o&&e(),t&&!o&&t()},g=function(t){t?(e("#overlay").show(),e("body").css({height:"100%",overflow:"hidden"}),window.scrollTo(0,0)):(e("#overlay").hide(),e("body").css({height:"auto",overflow:"visible"}))},m=function(){var e={};return 0===document.location.search.indexOf("?d=")&&(e.d=document.location.search.substring(3)),e},h=-1,f=function(){var t,o,i=m();if(i.d){var n=i.d.split("-"),a=new Date(n[0],n[1]-1,n[2]);t=a.getDate()+"."+(a.getMonth()+1)+"."+a.getFullYear(),o=a.getTime()/1e3}else t="Heute",o=!1;g(!0),e.ajax({data:{type:"getTrainData",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),d:o}}).done(function(t){return""!==t&&(t=JSON.parse(t)),t.error?void c():(t.id?(h=t.id,e("#data_header").show(),e("#train_start").html(t.start_Hi),t.endebutton?t.autoended&&e("#training_notended").show():(e("#training_ended").show(),e("#train_ende").html(t.ende_Hi),e("#train_duration").html(t.duration)),e("#cb_brust").prop("checked","1"===t.cb_brust),e("#cb_schulter").prop("checked","1"===t.cb_schulter),e("#cb_ruecken").prop("checked","1"===t.cb_ruecken),e("#cb_bizeps").prop("checked","1"===t.cb_bizeps),e("#cb_trizeps").prop("checked","1"===t.cb_trizeps),e("#cb_bauch").prop("checked","1"===t.cb_bauch),e("#cb_oberschenkel").prop("checked","1"===t.cb_oberschenkel),e("#cb_wade").prop("checked","1"===t.cb_wade),e("#cb_ausdauer").prop("checked","1"===t.cb_ausdauer),e("#cb_kampfsport").prop("checked","1"===t.cb_kampfsport),e("#cb_gymnastik").prop("checked","1"===t.cb_gymnastik),e("#cb_squash").prop("checked","1"===t.cb_squash),e("input[type=checkbox]").makeNiceCheckbox(),e("#traindata").show()):o?e("#error1").show():e("#error2").show(),void g(!1))}).fail(function(){b()}),e(".mobile_content > h1").html(t)},b=function(){g(!1),setTimeout(function(){top.location.href="index.html?error3"},200)};e(document).on("click","#loginbutton",s),e(document).on("submit","form",function(e){e.preventDefault()}),e(document).on("change","#selectYear",function(e){e.preventDefault(),n(this.value)}),e(document).on("click",".stoptrain_delete",function(){g(!0),e.ajax({data:{type:"stoptrain_delete",id:h,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid")}}).done(function(e){return""!==e&&(e=JSON.parse(e)),e.error?void c():void top.location.reload()}).fail(function(){b()})}),e(document).on("click",".fitcom-verlassen",function(){g(!0),e.ajax({data:{type:"stoptrain",id:h,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid")}}).done(function(e){return""!==e&&(e=JSON.parse(e)),e.error?void c():void top.location.reload()}).fail(function(){b()})}),e(document).on("click",".training-speichern",function(){g(!0),e.ajax({data:{type:"savetraining",id:h,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),cb_brust:e("#cb_brust").prop("checked")?1:0,cb_schulter:e("#cb_schulter").prop("checked")?1:0,cb_ruecken:e("#cb_ruecken").prop("checked")?1:0,cb_bizeps:e("#cb_bizeps").prop("checked")?1:0,cb_trizeps:e("#cb_trizeps").prop("checked")?1:0,cb_bauch:e("#cb_bauch").prop("checked")?1:0,cb_oberschenkel:e("#cb_oberschenkel").prop("checked")?1:0,cb_wade:e("#cb_wade").prop("checked")?1:0,cb_ausdauer:e("#cb_ausdauer").prop("checked")?1:0,cb_kampfsport:e("#cb_kampfsport").prop("checked")?1:0,cb_gymnastik:e("#cb_gymnastik").prop("checked")?1:0,cb_squash:e("#cb_squash").prop("checked")?1:0}}).done(function(e){return""!==e&&(e=JSON.parse(e)),e.error?void c():void g(!1)}).fail(function(){b()})}),e(document).on("click",".passwort-speichern",function(){e("#msg1, #msg2").hide(),g(!0),e.ajax({data:{type:"changepwd",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),"pw-old":e("#pw-old").val(),"pw-new":e("#pw-new").val(),"pw-new-2":e("#pw-new-2").val()}}).done(function(t){return e("#pw-old").val(""),e("#pw-new").val(""),e("#pw-new-2").val(""),g(!1),""!==t&&(t=JSON.parse(t)),t.error?void c():(1===t.msg&&e("#msg1").show(),void(2===t.msg&&e("#msg2").show()))}).fail(function(){b()})})}(jQuery);