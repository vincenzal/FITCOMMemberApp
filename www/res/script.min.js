!function(a){"use strict";a.ajaxSetup({url:"http://fitcom.plusdrei.at/mobile/app.1.2.x/",method:"POST"});var b=2016,c="1.2.0";a(document).ready(function(){function b(){switch("undefined"!=typeof StatusBar&&StatusBar.hide(),document.addEventListener("resume",function(){setTimeout(function(){top.location.href="userbereich.html"},20)},!1),a("body").append(a('<div id="overlay"><span></span></div>')),a("body").attr("id")){case"site-index":a("input[type=checkbox]").makeNiceCheckbox(),"?logout"===document.location.search?(l("logout"),h(),a("#error2").show()):"?error3"===document.location.search?(a("h1, hr, .sitetext, #disclaimer, #login-area").hide(),a("#error3").show()):(l("site-index"),m(j));break;case"site-userbereich":l("site-userbereich"),m(!1,function(){setTimeout(function(){h(),top.location.href="index.html"},200)}),q();break;case"site-pwdchange":l("site-pwdchange"),m(!1,function(){setTimeout(function(){h(),top.location.href="index.html"},200)});break;case"site-trainingsplan":l("site-trainingsplan"),m(!1,function(){setTimeout(function(){h(),top.location.href="index.html"},200)}),d()}}a("header button#nav-show").on("click",function(){return a(".site-nav ul").addClass("menu-visible"),a("#nav-show").removeClass("button-visible"),a("#nav-hide").addClass("button-visible"),!1}),a("header button#nav-hide").on("click",function(){a(".site-nav ul").removeClass("menu-visible"),a("#nav-hide").removeClass("button-visible"),a("#nav-show").addClass("button-visible")}),setTimeout(function(){h(),top.location.href="index.html"},72e5),document.addEventListener("deviceready",b,!1)});var d=function(){for(var c=new Date,d=c.getFullYear(),f=d;f>=b;f--)a("#selectYear").append(a("<option "+(f===d?"selected":"")+">"+f+"</option>"));e(d)},e=function(b){n(!0),a("#select-year-text span").html(b),a.ajax({data:{type:"loadtraining",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),year:b,checkTrainging:!0}}).done(function(a){return""!==a&&(a=JSON.parse(a)),a.error?void g():void("undefined"!=typeof a.days&&(a=a.days,f(b,a)))}).fail(function(){s()})},f=function(b,c){var e,f,g,h,i,j,d=new Date,k=["Jänner","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],l="";for(var m in k)if("string"==typeof k[m]){for(m*=1,l+='<table class="table-trainingsplan">',l+="<tr "+(m===d.getMonth()&&1*b===d.getFullYear()?'data-scrollhere="1"':"")+'><td class="table-month" colspan="7">'+k[m]+"</td></tr>",l+='<tr class="training-week"><td>Mo</td><td>Di</td><td>Mi</td><td>Do</td><td>Fr</td><td>Sa</td><td>So</td></tr>',e=new Date(b,m+1,0),f=new Date(b,m,1),g=f.getDay()-2,h=e.getDate(),g<-1&&(g+=7),i=0;i<(h+g>=35?42:35);i++)i%7===0&&(l+="<tr>"),h>=i-g&&i-g>0?(j=b+"-"+(m+1<10?"0":"")+(m+1)+"-"+(i-g<10?"0":"")+(i-g),l+=c.indexOf(j)>-1?'<td class="training-day-active '+(c.indexOf("X"+j)>-1?"training-day-active-data":"")+' training-ok"><a href="userbereich.html?d='+j+'">'+(i-g)+"</a></td>":'<td class="training-day-active">'+(i-g)+"</td>"):l+="<td></td>",i%7===6&&(l+="</tr>");l+="</table>"}if(a("#cal").html(l),n(!1),a('[data-scrollhere="1"]').length>0){var o=a('[data-scrollhere="1"]').offset();window.scrollTo(0,o.top-30)}},g=function(){top.location.href="index.html?logout"},h=function(){sessionStorage.clear(),localStorage.clear()},i=function(b){return b.preventDefault(),""!==a("#username").val()&&""!==a("#password").val()&&(n(!0),void a.ajax({data:{type:"login",email:a("#username").val(),password:a("#password").val(),eingeloggtbleiben:a("#eingeloggtbleiben").prop("checked")}}).done(function(b){return""!==b&&(b=JSON.parse(b)),b.error?void g():void(b.userOK?(sessionStorage.setItem("fitcomLogin",!0),sessionStorage.setItem("fitcomLogin_uid",b.uid),sessionStorage.setItem("fitcomLogin_sid",b.sid),a("#eingeloggtbleiben").prop("checked")&&(localStorage.setItem("fitcomLogin",!0),localStorage.setItem("fitcomLogin_uid",b.uid),localStorage.setItem("fitcomLogin_sid",b.sid)),j()):(l("wrong-login "+a("#username").val()),setTimeout(function(){n(!1),a("#error1").show()},2e3)))}).fail(function(){s()}))},j=function(){setTimeout(function(){top.location.href="userbereich.html"},200)},k=function(b){var c="";switch(device.platform){case"Android":c=b.androidStoreLink;break;case"iOS":c=b.iOSStoreLink}a("body").append(a('<div id="overlayStore"><p>Es gibt eine neue Version der FITCOM-App. Bitte mache ein Update.</p><p><br><br>'+c+"</p></div>").show())};a(document).on("click","a[target=_blank]",function(a){a.preventDefault(),window.open(this.href,"_system")}),a(document).on("click","a[target=_system]",function(a){a.preventDefault(),window.open(this.href,"_system")});var l=function(b){a.ajax({data:{type:"logit",uid:sessionStorage.getItem("fitcomLogin_uid"),content:b,appVersion:c}}).done(function(a){""!==a&&(a=JSON.parse(a)),a.update&&k(a)}).fail(function(){s()})},m=function(a,b){localStorage.getItem("fitcomLogin")&&!sessionStorage.getItem("fitcomLogin")&&(sessionStorage.setItem("fitcomLogin",!0),sessionStorage.setItem("fitcomLogin_uid",localStorage.getItem("fitcomLogin_uid")),sessionStorage.setItem("fitcomLogin_sid",localStorage.getItem("fitcomLogin_sid")));var c=localStorage.getItem("fitcomLogin")||sessionStorage.getItem("fitcomLogin");a&&c&&a(),b&&!c&&b()},n=function(b){b?(a("#overlay").show(),a("body").css({height:"100%",overflow:"hidden"}),window.scrollTo(0,0)):(a("#overlay").hide(),a("body").css({height:"auto",overflow:"visible"}))},o=function(){var a={};return 0===document.location.search.indexOf("?d=")&&(a.d=document.location.search.substring(3)),a},p=-1,q=function(){var b,c,d=o();if(d.d){var e=d.d.split("-"),f=new Date(e[0],e[1]-1,e[2]);b=f.getDate()+"."+(f.getMonth()+1)+"."+f.getFullYear(),c=f.getTime()/1e3}else b="Heute",c=!1;n(!0),a.ajax({data:{type:"getTrainData",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),d:c}}).done(function(b){return""!==b&&(b=JSON.parse(b)),b.error?void g():(b.next?a("#btn_next").attr("href","userbereich.html?d="+b.next):a("#btn_next").addClass("disabled"),b.prev?a("#btn_prev").attr("href","userbereich.html?d="+b.prev):a("#btn_prev").addClass("disabled"),b.id?(p=b.id,a("#data_header").show(),a("#train_start").html(b.start_Hi),b.endebutton?b.autoended&&a("#training_notended").show():(a("#training_ended").show(),a("#train_ende").html(b.ende_Hi),a("#train_duration").html(b.duration)),a("#cb_brust").prop("checked","1"===b.cb_brust),a("#cb_schulter").prop("checked","1"===b.cb_schulter),a("#cb_ruecken").prop("checked","1"===b.cb_ruecken),a("#cb_bizeps").prop("checked","1"===b.cb_bizeps),a("#cb_trizeps").prop("checked","1"===b.cb_trizeps),a("#cb_bauch").prop("checked","1"===b.cb_bauch),a("#cb_oberschenkel").prop("checked","1"===b.cb_oberschenkel),a("#cb_wade").prop("checked","1"===b.cb_wade),a("#cb_ausdauer").prop("checked","1"===b.cb_ausdauer),a("#cb_kampfsport").prop("checked","1"===b.cb_kampfsport),a("#cb_gymnastik").prop("checked","1"===b.cb_gymnastik),a("#cb_squash").prop("checked","1"===b.cb_squash),a("#txt_brust").val(b.txt_brust),a("#txt_schulter").val(b.txt_schulter),a("#txt_ruecken").val(b.txt_ruecken),a("#txt_bizeps").val(b.txt_bizeps),a("#txt_trizeps").val(b.txt_trizeps),a("#txt_bauch").val(b.txt_bauch),a("#txt_oberschenkel").val(b.txt_oberschenkel),a("#txt_wade").val(b.txt_wade),a("#txt_ausdauer").val(b.txt_ausdauer),a("#txt_kampfsport").val(b.txt_kampfsport),a("#txt_gymnastik").val(b.txt_gymnastik),a("#txt_squash").val(b.txt_squash),a("input[type=checkbox]").makeNiceCheckbox(),a("#traindata").show(),a("#training-auswahl input[type=checkbox]").each(function(){if(a(this).is(":checked")){var b=a(this).parent().parent().find("textarea");b.toggle(),b.css({height:0}),b.css({height:b.get(0).scrollHeight-7})}})):c?a("#error1").show():a("#error2").show(),void n(!1))}).fail(function(){s()}),a(".mobile_content > h1").html(b)},r=function(b){n(!0),a.ajax({data:{type:"savetraining",id:p,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),cb_brust:a("#cb_brust").prop("checked")?1:0,cb_schulter:a("#cb_schulter").prop("checked")?1:0,cb_ruecken:a("#cb_ruecken").prop("checked")?1:0,cb_bizeps:a("#cb_bizeps").prop("checked")?1:0,cb_trizeps:a("#cb_trizeps").prop("checked")?1:0,cb_bauch:a("#cb_bauch").prop("checked")?1:0,cb_oberschenkel:a("#cb_oberschenkel").prop("checked")?1:0,cb_wade:a("#cb_wade").prop("checked")?1:0,cb_ausdauer:a("#cb_ausdauer").prop("checked")?1:0,cb_kampfsport:a("#cb_kampfsport").prop("checked")?1:0,cb_gymnastik:a("#cb_gymnastik").prop("checked")?1:0,cb_squash:a("#cb_squash").prop("checked")?1:0,txt_brust:a("#txt_brust").val(),txt_schulter:a("#txt_schulter").val(),txt_ruecken:a("#txt_ruecken").val(),txt_bizeps:a("#txt_bizeps").val(),txt_trizeps:a("#txt_trizeps").val(),txt_bauch:a("#txt_bauch").val(),txt_oberschenkel:a("#txt_oberschenkel").val(),txt_wade:a("#txt_wade").val(),txt_ausdauer:a("#txt_ausdauer").val(),txt_kampfsport:a("#txt_kampfsport").val(),txt_gymnastik:a("#txt_gymnastik").val(),txt_squash:a("#txt_squash").val()}}).done(function(){n(!1),b&&b()})},s=function(){n(!1),setTimeout(function(){top.location.href="index.html?error3"},200)};a(document).on("click","#loginbutton",i),a(document).on("submit","form",function(a){a.preventDefault()});var t=!1;a(document).on("change","#training-auswahl input[type=checkbox]",function(b){a(this).parent().parent().find("textarea").toggle(),t=!0}),a(document).on("click",".inputwrapper canvas",function(b){a(this).parent().parent().find("textarea").toggle(),t=!0}),a(document).on("keyup change","textarea",function(b){a(this).css({height:0}),a(this).css({height:a(this).get(0).scrollHeight-7}),t=!0}),a(document).on("change","#selectYear",function(a){a.preventDefault(),e(this.value)}),a(document).on("click",".stoptrain_delete",function(){n(!0),a.ajax({data:{type:"stoptrain_delete",id:p,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid")}}).done(function(a){return""!==a&&(a=JSON.parse(a)),a.error?void g():void top.location.reload()}).fail(function(){s()})}),a(document).on("click",".fitcom-verlassen",function(){n(!0),a.ajax({data:{type:"stoptrain",id:p,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid")}}).done(function(a){return""!==a&&(a=JSON.parse(a)),a.error?void g():void top.location.reload()}).fail(function(){s()})}),a(document).on("click",".training-speichern",function(){r()}),a(document).on("click",".passwort-speichern",function(){a("#msg1, #msg2").hide(),n(!0),a.ajax({data:{type:"changepwd",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),"pw-old":a("#pw-old").val(),"pw-new":a("#pw-new").val(),"pw-new-2":a("#pw-new-2").val()}}).done(function(b){return a("#pw-old").val(""),a("#pw-new").val(""),a("#pw-new-2").val(""),n(!1),""!==b&&(b=JSON.parse(b)),b.error?void g():(1===b.msg&&a("#msg1").show(),void(2===b.msg&&a("#msg2").show()))}).fail(function(){s()})}),a(document).on("click",".btn",function(b){if(a(this).hasClass("disabled"))return b.preventDefault(),!1;if(t){b.preventDefault();var c=a(this).attr("href");r(function(){top.location.href=c})}})}(jQuery);