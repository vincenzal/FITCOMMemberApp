!function(e){"use strict";e.ajaxSetup({url:"http://fitcom.plusdrei.at/mobile/app/",method:"POST"});var t=2014;e(document).ready(function(){switch(e("header button#nav-show").on("click",function(){return e(".site-nav ul").addClass("menu-visible"),e("#nav-show").removeClass("button-visible"),e("#nav-hide").addClass("button-visible"),!1}),e("header button#nav-hide").on("click",function(){e(".site-nav ul").removeClass("menu-visible"),e("#nav-hide").removeClass("button-visible"),e("#nav-show").addClass("button-visible")}),setTimeout(function(){top.location.href="index.html"},72e5),e("body").append(e('<div id="overlay"><img src="images/ajax-loader.gif"></div>')),e("body").attr("id")){case"site-index":e("input[type=checkbox]").makeNiceCheckbox(),"?logout"===document.location.search?(r("logout"),a()):(r("site-index"),d(s));break;case"site-userbereich":r("site-userbereich"),d(!1,function(){setTimeout(function(){top.location.href="index.html"},200)}),g();break;case"site-pwdchange":r("site-pwdchange"),d(!1,function(){setTimeout(function(){top.location.href="index.html"},200)});break;case"site-trainingsplan":r("site-trainingsplan"),d(!1,function(){setTimeout(function(){top.location.href="index.html"},200)}),o()}});var o=function(){for(var o=new Date,n=o.getFullYear(),a=n;a>=t;a--)e("#selectYear").append(e("<option "+(a===n?"selected":"")+">"+a+"</option>"));i(n)},i=function(t){u(!0),e("#select-year-text span").html(t),e.ajax({data:{type:"loadtraining",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),year:t}}).done(function(e){""!==e&&(e=JSON.parse(e),e=e.days),n(t,e)})},n=function(t,o){var i,n,a,c,s,r,d=new Date,l=["Jänner","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],p="";for(var g in l)if("string"==typeof l[g]){for(g*=1,p+='<table class="table-trainingsplan">',p+="<tr "+(g===d.getMonth()&&1*t===d.getFullYear()?'data-scrollhere="1"':"")+'><td class="table-month" colspan="7">'+l[g]+"</td></tr>",p+='<tr class="training-week"><td>Mo</td><td>Di</td><td>Mi</td><td>Do</td><td>Fr</td><td>Sa</td><td>So</td></tr>',i=new Date(t,g+1,0),n=new Date(t,g,1),a=n.getDay()-2,c=i.getDate(),-1>a&&(a+=7),s=0;(c+a>=35?42:35)>s;s++)s%7===0&&(p+="<tr>"),c>=s-a&&s-a>0?(r=t+"-"+(10>g+1?"0":"")+(g+1)+"-"+(10>s-a?"0":"")+(s-a),p+=o.indexOf(r)>-1?'<td class="training-day-active training-ok"><a href="userbereich.html?d='+r+'">'+(s-a)+"</a></td>":'<td class="training-day-active">'+(s-a)+"</td>"):p+="<td></td>",s%7===6&&(p+="</tr>");p+="</table>"}if(e("#cal").html(p),u(!1),e('[data-scrollhere="1"]').length>0){var m=e('[data-scrollhere="1"]').offset();window.scrollTo(0,m.top-30)}},a=function(){sessionStorage.clear(),localStorage.clear()},c=function(t){return t.preventDefault(),""===e("#username").val()||""===e("#password").val()?!1:(u(!0),void e.ajax({data:{type:"login",email:e("#username").val(),password:e("#password").val(),eingeloggtbleiben:e("#eingeloggtbleiben").prop("checked")}}).done(function(t){""!==t&&(t=JSON.parse(t)),t.userOK?(sessionStorage.setItem("fitcomLogin",!0),sessionStorage.setItem("fitcomLogin_uid",t.uid),sessionStorage.setItem("fitcomLogin_sid",t.sid),e("#eingeloggtbleiben").prop("checked")&&(localStorage.setItem("fitcomLogin",!0),localStorage.setItem("fitcomLogin_uid",t.uid),localStorage.setItem("fitcomLogin_sid",t.sid)),s()):(r("wrong-login "+e("#username").val()),setTimeout(function(){u(!1),e("#error1").show()},2e3))}))},s=function(){setTimeout(function(){top.location.href="userbereich.html"},200)},r=function(t){e.ajax({data:{type:"logit",uid:sessionStorage.getItem("fitcomLogin_uid"),content:t}})},d=function(e,t){localStorage.getItem("fitcomLogin")&&!sessionStorage.getItem("fitcomLogin")&&(sessionStorage.setItem("fitcomLogin",!0),sessionStorage.setItem("fitcomLogin_uid",localStorage.getItem("fitcomLogin_uid")),sessionStorage.setItem("fitcomLogin_sid",localStorage.getItem("fitcomLogin_sid")));var o=localStorage.getItem("fitcomLogin")||sessionStorage.getItem("fitcomLogin");e&&o&&e(),t&&!o&&t()},u=function(t){t?(e("#overlay").show(),e("body").css({height:"100%",overflow:"hidden"}),window.scrollTo(0,0)):(e("#overlay").hide(),e("body").css({height:"auto",overflow:"visible"}))},l=function(){var e={};return 0===document.location.search.indexOf("?d=")&&(e.d=document.location.search.substring(3)),e},p=-1,g=function(){var t,o,i=l();if(i.d){var n=i.d.split("-"),a=new Date(n[0],n[1]-1,n[2]);t=a.getDate()+"."+(a.getMonth()+1)+"."+a.getFullYear(),o=a.getTime()/1e3}else t="Heute",o=!1;u(!0),e.ajax({data:{type:"getTrainData",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),d:o}}).done(function(t){""!==t&&(t=JSON.parse(t)),t.id?(p=t.id,e("#data_header").show(),e("#train_start").html(t.start_Hi),t.endebutton?t.autoended&&e("#training_notended").show():(e("#training_ended").show(),e("#train_ende").html(t.ende_Hi),e("#train_duration").html(t.duration)),e("#cb_brust").prop("checked","1"===t.cb_brust),e("#cb_schulter").prop("checked","1"===t.cb_schulter),e("#cb_ruecken").prop("checked","1"===t.cb_ruecken),e("#cb_bizeps").prop("checked","1"===t.cb_bizeps),e("#cb_trizeps").prop("checked","1"===t.cb_trizeps),e("#cb_bauch").prop("checked","1"===t.cb_bauch),e("#cb_oberschenkel").prop("checked","1"===t.cb_oberschenkel),e("#cb_wade").prop("checked","1"===t.cb_wade),e("#cb_ausdauer").prop("checked","1"===t.cb_ausdauer),e("#cb_kampfsport").prop("checked","1"===t.cb_kampfsport),e("#cb_gymnastik").prop("checked","1"===t.cb_gymnastik),e("#cb_squash").prop("checked","1"===t.cb_squash),e("input[type=checkbox]").makeNiceCheckbox(),e("#traindata").show()):o?e("#error1").show():e("#error2").show(),u(!1)}),e(".mobile_content > h1").html(t)};e(document).on("click","#loginbutton",c),e(document).on("submit","form",function(e){e.preventDefault()}),e(document).on("focus","input",function(){e(this).prop("readonly",!1)}),e(document).on("blur","input",function(){e(this).prop("readonly",!0)}),e(document).on("change","#selectYear",function(e){e.preventDefault(),i(this.value)}),e(document).on("click",".stoptrain_delete",function(){u(!0),e.ajax({data:{type:"stoptrain_delete",id:p,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid")}}).done(function(){top.location.reload()})}),e(document).on("click",".fitcom-verlassen",function(){u(!0),e.ajax({data:{type:"stoptrain",id:p,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid")}}).done(function(){top.location.reload()})}),e(document).on("click",".training-speichern",function(){u(!0),e.ajax({data:{type:"savetraining",id:p,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),cb_brust:e("#cb_brust").prop("checked")?1:0,cb_schulter:e("#cb_schulter").prop("checked")?1:0,cb_ruecken:e("#cb_ruecken").prop("checked")?1:0,cb_bizeps:e("#cb_bizeps").prop("checked")?1:0,cb_trizeps:e("#cb_trizeps").prop("checked")?1:0,cb_bauch:e("#cb_bauch").prop("checked")?1:0,cb_oberschenkel:e("#cb_oberschenkel").prop("checked")?1:0,cb_wade:e("#cb_wade").prop("checked")?1:0,cb_ausdauer:e("#cb_ausdauer").prop("checked")?1:0,cb_kampfsport:e("#cb_kampfsport").prop("checked")?1:0,cb_gymnastik:e("#cb_gymnastik").prop("checked")?1:0,cb_squash:e("#cb_squash").prop("checked")?1:0}}).done(function(){u(!1)})}),e(document).on("click",".passwort-speichern",function(){e("#msg1, #msg2").hide(),u(!0),e.ajax({data:{type:"changepwd",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),"pw-old":e("#pw-old").val(),"pw-new":e("#pw-new").val(),"pw-new-2":e("#pw-new-2").val()}}).done(function(t){e("#pw-old").val(""),e("#pw-new").val(""),e("#pw-new-2").val(""),u(!1),""!==t&&(t=JSON.parse(t)),1===t.msg&&e("#msg1").show(),2===t.msg&&e("#msg2").show()})})}(jQuery);