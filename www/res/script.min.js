!function(e){"use strict";e.ajaxSetup({url:"http://fitcom.plusdrei.at/mobile/app/",method:"POST"});var t=2016;e(document).ready(function(){function t(){StatusBar.hide(),document.addEventListener("resume",function(){setTimeout(function(){top.location.href="userbereich.html"},20)},!1)}switch(e("header button#nav-show").on("click",function(){return e(".site-nav ul").addClass("menu-visible"),e("#nav-show").removeClass("button-visible"),e("#nav-hide").addClass("button-visible"),!1}),e("header button#nav-hide").on("click",function(){e(".site-nav ul").removeClass("menu-visible"),e("#nav-hide").removeClass("button-visible"),e("#nav-show").addClass("button-visible")}),setTimeout(function(){c(),top.location.href="index.html"},72e5),e("body").append(e('<div id="overlay"><span></span></div>')),e("body").attr("id")){case"site-index":e("input[type=checkbox]").makeNiceCheckbox(),"?logout"===document.location.search?(d("logout"),c(),e("#error2").show()):"?error3"===document.location.search?(e("h1, hr, .sitetext, #disclaimer, #login-area").hide(),e("#error3").show()):(d("site-index"),u(s));break;case"site-userbereich":d("site-userbereich"),u(!1,function(){setTimeout(function(){c(),top.location.href="index.html"},200)}),m();break;case"site-pwdchange":d("site-pwdchange"),u(!1,function(){setTimeout(function(){c(),top.location.href="index.html"},200)});break;case"site-trainingsplan":d("site-trainingsplan"),u(!1,function(){setTimeout(function(){c(),top.location.href="index.html"},200)}),o()}document.addEventListener("deviceready",t,!1)});var o=function(){for(var o=new Date,n=o.getFullYear(),a=n;a>=t;a--)e("#selectYear").append(e("<option "+(a===n?"selected":"")+">"+a+"</option>"));i(n)},i=function(t){l(!0),e("#select-year-text span").html(t),e.ajax({data:{type:"loadtraining",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),year:t,checkTrainging:!0}}).done(function(e){return""!==e&&(e=JSON.parse(e)),e.error?void a():void(e.days&&(e=e.days,n(t,e)))}).fail(function(){h()})},n=function(t,o){var i,n,a,c,r,s,d=new Date,u=["Jänner","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],p="";for(var g in u)if("string"==typeof u[g]){for(g*=1,p+='<table class="table-trainingsplan">',p+="<tr "+(g===d.getMonth()&&1*t===d.getFullYear()?'data-scrollhere="1"':"")+'><td class="table-month" colspan="7">'+u[g]+"</td></tr>",p+='<tr class="training-week"><td>Mo</td><td>Di</td><td>Mi</td><td>Do</td><td>Fr</td><td>Sa</td><td>So</td></tr>',i=new Date(t,g+1,0),n=new Date(t,g,1),a=n.getDay()-2,c=i.getDate(),-1>a&&(a+=7),r=0;(c+a>=35?42:35)>r;r++)r%7===0&&(p+="<tr>"),c>=r-a&&r-a>0?(s=t+"-"+(10>g+1?"0":"")+(g+1)+"-"+(10>r-a?"0":"")+(r-a),p+=o.indexOf(s)>-1?'<td class="training-day-active '+(o.indexOf("X"+s)>-1?"training-day-active-data":"")+' training-ok"><a href="userbereich.html?d='+s+'">'+(r-a)+"</a></td>":'<td class="training-day-active">'+(r-a)+"</td>"):p+="<td></td>",r%7===6&&(p+="</tr>");p+="</table>"}if(e("#cal").html(p),l(!1),e('[data-scrollhere="1"]').length>0){var m=e('[data-scrollhere="1"]').offset();window.scrollTo(0,m.top-30)}},a=function(){top.location.href="index.html?logout"},c=function(){sessionStorage.clear(),localStorage.clear()},r=function(t){return t.preventDefault(),""===e("#username").val()||""===e("#password").val()?!1:(l(!0),void e.ajax({data:{type:"login",email:e("#username").val(),password:e("#password").val(),eingeloggtbleiben:e("#eingeloggtbleiben").prop("checked")}}).done(function(t){return""!==t&&(t=JSON.parse(t)),t.error?void a():void(t.userOK?(sessionStorage.setItem("fitcomLogin",!0),sessionStorage.setItem("fitcomLogin_uid",t.uid),sessionStorage.setItem("fitcomLogin_sid",t.sid),e("#eingeloggtbleiben").prop("checked")&&(localStorage.setItem("fitcomLogin",!0),localStorage.setItem("fitcomLogin_uid",t.uid),localStorage.setItem("fitcomLogin_sid",t.sid)),s()):(d("wrong-login "+e("#username").val()),setTimeout(function(){l(!1),e("#error1").show()},2e3)))}).fail(function(){h()}))},s=function(){setTimeout(function(){top.location.href="userbereich.html"},200)},d=function(t){e.ajax({data:{type:"logit",uid:sessionStorage.getItem("fitcomLogin_uid"),content:t}}).fail(function(){h()})},u=function(e,t){localStorage.getItem("fitcomLogin")&&!sessionStorage.getItem("fitcomLogin")&&(sessionStorage.setItem("fitcomLogin",!0),sessionStorage.setItem("fitcomLogin_uid",localStorage.getItem("fitcomLogin_uid")),sessionStorage.setItem("fitcomLogin_sid",localStorage.getItem("fitcomLogin_sid")));var o=localStorage.getItem("fitcomLogin")||sessionStorage.getItem("fitcomLogin");e&&o&&e(),t&&!o&&t()},l=function(t){t?(e("#overlay").show(),e("body").css({height:"100%",overflow:"hidden"}),window.scrollTo(0,0)):(e("#overlay").hide(),e("body").css({height:"auto",overflow:"visible"}))},p=function(){var e={};return 0===document.location.search.indexOf("?d=")&&(e.d=document.location.search.substring(3)),e},g=-1,m=function(){var t,o,i=p();if(i.d){var n=i.d.split("-"),c=new Date(n[0],n[1]-1,n[2]);t=c.getDate()+"."+(c.getMonth()+1)+"."+c.getFullYear(),o=c.getTime()/1e3}else t="Heute",o=!1;l(!0),e.ajax({data:{type:"getTrainData",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),d:o}}).done(function(t){return""!==t&&(t=JSON.parse(t)),t.error?void a():(t.id?(g=t.id,e("#data_header").show(),e("#train_start").html(t.start_Hi),t.endebutton?t.autoended&&e("#training_notended").show():(e("#training_ended").show(),e("#train_ende").html(t.ende_Hi),e("#train_duration").html(t.duration)),e("#cb_brust").prop("checked","1"===t.cb_brust),e("#cb_schulter").prop("checked","1"===t.cb_schulter),e("#cb_ruecken").prop("checked","1"===t.cb_ruecken),e("#cb_bizeps").prop("checked","1"===t.cb_bizeps),e("#cb_trizeps").prop("checked","1"===t.cb_trizeps),e("#cb_bauch").prop("checked","1"===t.cb_bauch),e("#cb_oberschenkel").prop("checked","1"===t.cb_oberschenkel),e("#cb_wade").prop("checked","1"===t.cb_wade),e("#cb_ausdauer").prop("checked","1"===t.cb_ausdauer),e("#cb_kampfsport").prop("checked","1"===t.cb_kampfsport),e("#cb_gymnastik").prop("checked","1"===t.cb_gymnastik),e("#cb_squash").prop("checked","1"===t.cb_squash),e("input[type=checkbox]").makeNiceCheckbox(),e("#traindata").show()):o?e("#error1").show():e("#error2").show(),void l(!1))}).fail(function(){h()}),e(".mobile_content > h1").html(t)},h=function(){l(!1),setTimeout(function(){top.location.href="index.html?error3"},200)};e(document).on("click","#loginbutton",r),e(document).on("submit","form",function(e){e.preventDefault()}),e(document).on("change","#selectYear",function(e){e.preventDefault(),i(this.value)}),e(document).on("click",".stoptrain_delete",function(){l(!0),e.ajax({data:{type:"stoptrain_delete",id:g,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid")}}).done(function(e){return""!==e&&(e=JSON.parse(e)),e.error?void a():void top.location.reload()}).fail(function(){h()})}),e(document).on("click",".fitcom-verlassen",function(){l(!0),e.ajax({data:{type:"stoptrain",id:g,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid")}}).done(function(e){return""!==e&&(e=JSON.parse(e)),e.error?void a():void top.location.reload()}).fail(function(){h()})}),e(document).on("click",".training-speichern",function(){l(!0),e.ajax({data:{type:"savetraining",id:g,uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),cb_brust:e("#cb_brust").prop("checked")?1:0,cb_schulter:e("#cb_schulter").prop("checked")?1:0,cb_ruecken:e("#cb_ruecken").prop("checked")?1:0,cb_bizeps:e("#cb_bizeps").prop("checked")?1:0,cb_trizeps:e("#cb_trizeps").prop("checked")?1:0,cb_bauch:e("#cb_bauch").prop("checked")?1:0,cb_oberschenkel:e("#cb_oberschenkel").prop("checked")?1:0,cb_wade:e("#cb_wade").prop("checked")?1:0,cb_ausdauer:e("#cb_ausdauer").prop("checked")?1:0,cb_kampfsport:e("#cb_kampfsport").prop("checked")?1:0,cb_gymnastik:e("#cb_gymnastik").prop("checked")?1:0,cb_squash:e("#cb_squash").prop("checked")?1:0}}).done(function(e){return""!==e&&(e=JSON.parse(e)),e.error?void a():void l(!1)}).fail(function(){h()})}),e(document).on("click",".passwort-speichern",function(){e("#msg1, #msg2").hide(),l(!0),e.ajax({data:{type:"changepwd",uid:sessionStorage.getItem("fitcomLogin_uid"),sid:sessionStorage.getItem("fitcomLogin_sid"),"pw-old":e("#pw-old").val(),"pw-new":e("#pw-new").val(),"pw-new-2":e("#pw-new-2").val()}}).done(function(t){return e("#pw-old").val(""),e("#pw-new").val(""),e("#pw-new-2").val(""),l(!1),""!==t&&(t=JSON.parse(t)),t.error?void a():(1===t.msg&&e("#msg1").show(),void(2===t.msg&&e("#msg2").show()))}).fail(function(){h()})})}(jQuery);